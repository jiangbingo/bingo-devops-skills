# Git Commit Analyzer Skill

## 概述

这个 Skill 用于分析 Git 仓库的提交历史，提供详细的代码贡献统计、提交模式分析和质量评估。

## 文件结构

```
git-commit-analyzer/
├── SKILL.md          # Skill 定义文件
├── impl.py           # 实现脚本
├── test_skill.py     # 测试脚本
└── README.md         # 使用文档
```

## 功能特性

### 1. 基础统计
- 总提交数统计
- 贡献者数量
- 时间跨度分析
- 平均提交频率
- 提交信息平均长度

### 2. 贡献者排行榜
- 按提交数排名
- 显示每个贡献者的提交占比
- 可视化条形图展示

### 3. 活跃时段分析
- **小时热图**: 显示 24 小时内的提交分布
- **星期热图**: 显示一周内的提交分布
- **月度趋势**: 显示最近 12 个月的提交趋势
- **工作日 vs 周末**: 对比分析

### 4. 提交信息质量分析
- **约定式提交规范符合率**: 检查是否遵循 Conventional Commits
- **提交类型分布**: feat、fix、docs、style 等类型的统计
- **质量评估**: 提供改进建议

### 5. 智能建议
根据分析结果提供个性化的改进建议：
- 提交信息规范化建议
- 工作生活平衡提醒
- 健康作息建议

## 如何使用

### 方式 1: 直接运行脚本

在任何 Git 仓库目录中运行：

```bash
python3 skillsets/git-commit-analyzer/impl.py
```

### 方式 2: 运行测试脚本

```bash
python3 skillsets/git-commit-analyzer/test_skill.py
```

### 方式 3: 通过 Skill 触发

在对话中使用以下短语触发：

**分析提交历史**
- "分析提交历史"
- "查看代码贡献统计"
- "谁提交最多"
- "分析这个项目的提交"

**检查提交模式**
- "什么时候提交最多"
- "查看提交模式"
- "分析提交频率"
- "查看活跃时段"

**评估提交质量**
- "检查提交信息质量"
- "提交信息是否符合规范"
- "分析提交规范"

## 输出文件

执行后会生成 `commit_analysis_report.txt` 文件，包含：

```
================================================================================
Git 提交历史分析报告
分析时间: 2026-01-30 17:30:00
================================================================================

================================================================================
📊 基础统计
================================================================================
总提交数: 150
贡献者数: 5
时间范围: 2025-01-01 至 2026-01-30
跨度天数: 395 天
平均提交频率: 0.38 提交/天
平均信息长度: 45.2 字符

================================================================================
👥 贡献者排行榜
================================================================================
排名   贡献者                          提交数     占比
----------------------------------------------------------------------------
1      Zhang San                       80        53.3% ████████████████████████████████
2      Li Si                           40        26.7% ████████████████
3      Wang Wu                         20        13.3% ███████
4      Zhao Liu                        8         5.3%  ██
5      Sun Qi                          2         1.3%  ▌

================================================================================
⏰ 提交时段热图（按小时）
================================================================================
00:00                                         0
01:00                                         0
...
10:00 ████████████████████████████████       25 👈
11:00 ████████████████████████████████       28 👈
12:00 ██████████████████████████████████████ 35
...
```

## 约定式提交规范

Skill 会检查提交信息是否符合以下规范：

| 类型 | 说明 | 示例 |
|------|------|------|
| `feat` | 新功能 | `feat: 添加用户登录功能` |
| `fix` | 修复 Bug | `fix: 修复登录页面显示问题` |
| `docs` | 文档变更 | `docs: 更新 README 文档` |
| `style` | 代码格式 | `style: 统一代码缩进` |
| `refactor` | 重构 | `refactor: 优化数据库查询逻辑` |
| `test` | 测试 | `test: 添加单元测试` |
| `chore` | 构建/工具 | `chore: 更新依赖包` |
| `perf` | 性能优化 | `perf: 优化查询性能` |
| `ci` | CI 配置 | `ci: 更新 GitHub Actions` |
| `build` | 构建系统 | `build: 更新 webpack 配置` |

## 技术实现

### 使用的 Git 命令

```bash
# 获取提交数据（JSON 格式）
git log --pretty=format:'{"hash":"%H","author":"%an","date":"%ad","message":"%s"}' --date=iso
```

### 数据分析

- **贡献者分析**: 使用 `collections.Counter` 统计
- **时段分析**: 按小时、星期、月份分组统计
- **质量评估**: 正则表达式匹配约定式提交格式
- **可视化**: ASCII 字符绘制条形图

### 错误处理

- 自动检测是否在 Git 仓库中
- 处理非 UTF-8 编码的提交信息
- 优雅处理空仓库情况
- 完整的异常捕获和用户友好提示

## 依赖要求

- Python 3.x
- Git 命令行工具
- 无需额外 Python 库（仅使用标准库）

## 测试状态

✅ 所有测试通过

测试覆盖：
- 文件结构验证
- 脚本执行测试
- 输出文件验证
- 报告内容完整性检查

## 使用场景

### 项目管理
- 了解团队成员贡献分布
- 识别核心贡献者
- 跟踪项目活跃度

### 代码质量
- 评估提交信息规范性
- 发现提交模式问题
- 改进工作流程

### 团队协作
- 分析团队工作习惯
- 优化协作模式
- 提高代码审查效率

## 注意事项

1. **需要在 Git 仓库中运行**: 脚本会自动检查当前目录是否为 Git 仓库
2. **提交数量**: 大型仓库可能需要较长处理时间
3. **编码问题**: 部分特殊字符可能显示为占位符
4. **隐私保护**: 仅分析提交元数据，不读取代码内容

## 下一步

1. 查看生成的 `commit_analysis_report.txt` 获取详细分析
2. 根据报告中的改进建议优化提交流程
3. 定期运行分析以跟踪项目进展
4. 结合其他 DevOps 工具进行综合分析

## 相关资源

- [约定式提交规范](https://www.conventionalcommits.org/)
- [Git Log 文档](https://git-scm.com/docs/git-log)
- [项目仓库](https://github.com/your-org/bingo-devops-skills)
